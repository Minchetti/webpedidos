$(function(){function e(e,a,s,t,n){$("#avisos").removeClass("alert-info").removeClass("alert-danger").removeClass("alert-success").removeClass("alert-warning").addClass("alert "+e),$("#avisos > *").remove(),$("<strong>",{text:a+" : "}).appendTo("#avisos"),$("<p>").appendTo("#avisos").html(" "+s).prepend($("<i>",{class:"glyphicon "+t})),$(".form-signin").css("height","400px"),setTimeout(function(){$("#avisos > *").remove(),$(".form-signin").css("height","330px"),$("#avisos").removeClass("alert "+e)},n)}function a(a){var s=$("#txtSenha").val();$("#txtSenha").parent().parent().addClass("has-warning"),$("#txtSenha").select(),$(".login-button button").remove(),$("<button>",{id:"btn-desbloquear",class:"btn btn-lg btn-block",text:" Entrar",click:function(a){a.preventDefault();var s={senha:$("#txtSenha").val()},t=$("#txtUsuario").val(),n=new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&<>|ªº`´~¨§*])(?=.{8,})");if(n.test($("#txtSenha").val())){var r=new Autenticacao,o=r.NovaSenha(t,s);if(JSON.parse(o.status)){var i=new Autenticacao;i.setUsuario($("#txtUsuario").val()),i.setSenha($("#txtSenha").val());var l=i.Acessar();JSON.parse(l.acesso)&&sessionStorage.setItem("tipo",l.tipo),$(location).attr("href","principal")}else e("alert-info","ATENÇÃO",o.log,"glyphicon-exclamation-sign",8e3),$("#txtSenha").select(),$("#btn-desbloquear").removeClass("btn-success").removeClass("btn-warning").removeClass("btn-danger").addClass("btn-danger")}else e("alert-info","ATENÇÃO","A senha deve conter ao menos 1 caracter especial, 1 letra maiúscula, 1 letra minúscula, 1 número e no mínimo 8 caracteres!","glyphicon-exclamation-sign",8e3),$("#txtSenha").select(),$("#btn-desbloquear").removeClass("btn-success").removeClass("btn-warning").removeClass("btn-danger").addClass("btn-danger")}}).prepend($("<i>",{class:"fa fa-lock","aria-hidden":!0})).appendTo(".login-button"),$("#txtSenha").keyup(function(){s!==$.trim($("#txtSenha").val())&&$.trim($("#txtSenha").val())?($("#btn-desbloquear i").removeClass("fa-lock").addClass("fa-unlock").parent().removeClass("btn-warning").removeClass("btn-success").removeClass("btn-danger").addClass("btn-success"),$("#txtSenha").parent().parent().removeClass("has-warning").addClass("has-success")):($("#btn-desbloquear i").removeClass("fa-unlock").addClass("fa-lock").parent().removeClass("btn-warning").removeClass("btn-success").addClass("btn-danger"),$("#txtSenha").parent().parent().removeClass("has-success").addClass("has-danger"))})}function s(){$.trim($("#txtUsuario").val())&&$.trim($("#txtSenha").val())?$("#btn-entrar").removeClass("btn-danger").addClass("btn-success").prop("disabled",!1):$("#btn-entrar").removeClass("btn-success").addClass("btn-danger").prop("disabled",!0)}sessionStorage.removeItem("tipo"),$("#txtUsuario, #txtSenha").keyup(function(){s()}),$("#btn-entrar").click(function(s){s.preventDefault();var t=new Autenticacao,n=null;t.setUsuario($("#txtUsuario").val()),t.setSenha($("#txtSenha").val()),n=t.Acessar(),$.isEmptyObject(n)?e("alert-danger","ATENÇÃO","NÃO FOI POSSÍVEL CONECTAR AO SERVIDOR","glyphicon-warning-sign",5e3):JSON.parse(n.acesso)?$(location).attr("href",n.url):!!n.hasOwnProperty("primeiro_acesso")&&JSON.parse(n.primeiro_acesso)?(e("alert-info","INFORMAÇÃO",'Digite sua nova senha de acesso no campo "SENHA" acima',"glyphicon-exclamation-sign",5e3),$("#txtSenha").val("").focus(),a(n.temp)):!!n.hasOwnProperty("expirada")&&JSON.parse(n.expirada)?(e("alert-warning","ATENÇÃO","Senha expirada, por favor digite uma nova senha","glyphicon-time",8e3),a(n.temp)):(e("alert-danger","ATENÇÃO",n.motivo,"glyphicon-warning-sign",5e3),$.each(n,function(e,a){new RegExp("Usuário").test(a)&&$("#txtUsuario").parent().addClass("has-error"),new RegExp("Senha").test(a)&&$("#txtSenha").parent().addClass("has-error")}),setTimeout(function(){$("#txtUsuario").parent().removeClass("has-error"),$("#txtSenha").parent().removeClass("has-error")},5e3))})});